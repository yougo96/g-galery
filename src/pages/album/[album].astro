---
import Img from '../../components/Img.astro';
import Layout from '../../layouts/Layout.astro';

const { album } = Astro.params;

const response = await fetch(`https://photoslibrary.googleapis.com/v1/mediaItems:search`, {
	method: 'POST',
	headers: {
		'Content-Type': 'application/json',
		Authorization: `Bearer ${import.meta.env.AccessToken}`,
	},
    body: JSON.stringify({
        albumId: album,
        pageSize: 50,
    })
});
const datas = await response.json();
// console.log(datas);
---

<Layout title="g-galery>album">
    <main style="grid-area: main;">
        <!-- <pre>
            {JSON.stringify(datas, null, 2)}
        </pre> -->
        <a href="/" style="display: block; width: 100%; text-align: center; text-decoration: none; color: var(--color-main);">â¬†</a>
        <hr>
        <div class="img-container">
            {datas.mediaItems ? 
                (datas.mediaItems.map(item => <Img url={item.baseUrl} data={item} />)) : (<span class="error">No images</span>)
            }
        </div>
    </main>
</Layout>

<style>
    .img-container {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        gap: var(--grid-gap);
    }
</style>